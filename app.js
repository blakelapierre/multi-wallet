!function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var s=e[u]={exports:{}};n[u][0].call(s.exports,function(t){var e=n[u][1][t];return r(e||t)},s,s.exports,t,n,e,o)}return e[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n,e){"use strict";var o=t("preact-cycle"),r=t("./coins");console.log(r.coins);(0,o.render)(function(t){var n=t.coins;return(0,o.h)("ui",null,(0,o.h)(r.CoinsUI,{coins:n}))},{coins:r.coins},document.body)},{"./coins":3,"preact-cycle":"preact-cycle"}],2:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("preact-cycle"),r=u(t("bitcore-lib-cash")),i=t("./utils");u(t("./identifier"));function u(t){return t&&t.__esModule?t:{default:t}}function a(t){if(null==t)throw new TypeError("Cannot destructure undefined")}r.default;function c(t,n,e){return console.log("set_utxos",t,n,e),n.utxos=e,t.utxos=e,t}function l(t,n,e){return n.mempoolUtxos=e,t.mempoolUtxos=e,t}var s=function(t,n,e){return console.log("init",{_:t}),t.mutation=n,t.transactionList=[],function(t,n,e){t.data=e,t.utxos=[],t.mempoolUtxos=[],e.utxos=t.utxos,e.mempoolUtxos=t.mempoolUtxos;var o=e.data.wallets.find(function(t){return t.pubKeyAddressString==k.toString()});console.log({wallet:o});var r=o.pubKeyAddressString;fetch("https://api.blockchair.com/bitcoin-cash/outputs?q=recipient("+r.split(":")[1]+")").then(function(t){return t.json()}).then(function(t){n(c)(o,t.data)}),fetch("https://api.blockchair.com/bitcoin-cash/mempool/outputs?q=recipient("+r.split(":")[1]+")").then(function(t){return t.json()}).then(function(t){n(l)(o,t.data)})}(t,n,e),t},d=function(t){return t},f=function(t,n){return t.transactionList.push(n),n.__sendValue=n.value,n.__isSending=!0,t},h=function(t,n,e){return"0"===e?n.__isSending=!1:n.__sendValue=e,console.log(n),t},p=function(t,n,e){return n.__toAddress=e,r.default.Address.isValid(e)&&(n.__toAddressImg=function(t){0!==t.indexOf("bitcoincash:")&&(t="bitcoincash:"+t);for(var n=0;n<7;n++)for(var e=0;e<8;e++)if(!(1+8*n+e>53)){var o=t.charCodeAt(8*n+e),r=(o>>>4|o<<4)>>>4|(o>>>4|o<<4)<<4;console.log("code",o),_.data[0]=Math.floor(255*b(r)),_.data[1]=Math.floor(255*b(r+1)),_.data[2]=Math.floor(255*b(r+2)),_.data[3]=255,console.log(_.data),g.putImageData(_,e,n)}return g.imageSmoothingEnabled=!1,m.toDataURL()}(e)),t},v=function(t,n){return t.sendFee=n,t},m=document.createElement("canvas"),g=m.getContext("2d"),_=new ImageData(1,1);m.width=8,m.height=7;function b(t){var n=1e4*Math.sin(t++);return n-Math.floor(n)}var y=function(t,n){return alert("not imple"),t};console.log({btc:r.default});var x=new r.default.PrivateKey;try{var C=localStorage.getItem("bch-private-key");C?x=new r.default.PrivateKey(C):localStorage.setItem("bch-private-key",x.toWIF())}catch(t){alert('localStorage not supported!!!!!!!! private key may not be saved!!!!!!!!!!!!!!!!!!!! private key "WIF": '+x.toWIF())}var I=x.toPublicKey(),S=x.toAddress(),k=I.toAddress();console.log({pk:x,address:S,pubKey:I,pubAddress:k}),console.log(S.hashBuffer.toString("UTF-8"),k.toString());var U=function(t){var n=t.children;return(0,o.h)("satoshis",null,function(t,n){for(var e=new Array(Math.ceil(t.length/n)),o=0;o<e.length;o++){var r=0===o?0:t.length-n*(e.length-o),i=0===o?t.length%n==0?n:t.length%n:n;e[o]=t.substr(r,i),console.log(t,n,r,i,e),console.log(e,o,n,o*n,t.length,o*n>t.length-1?0:t.length-1-o*n,(e.length-o)*n)}return 0===e.length?["0"]:e}(n[0],3).join(" "))};var w=function(t,n){var e=n.utxos,r=n.mempoolUtxos;return a(t),(0,o.h)("balance",null,(0,o.h)("confirmed",null,"Confirmed: ",(0,o.h)(U,null,e.reduce(function(t,n){return t+n.value},0))),(0,o.h)("mempool",null,"Mempool: ",(0,o.h)(U,null,r.reduce(function(t,n){return t+n.value},0))))},M=function(t,n){var e=n.utxos,r=n.mempoolUtxos;return a(t),(0,o.h)("coins",null,e.map(function(t){return(0,o.h)(A,{className:"confirmed",tx:t})}),r.map(function(t){return(0,o.h)(A,{className:"mempool",tx:t})}))},A=function(t,n){var e=t.tx,r=n.mutation;return(0,o.h)("coin",{class:-1===e.block_id?"mempool":"confirmed"},(0,o.h)("a",{target:"__blank",href:"https://blockchair.com/bitcoin-cash/transaction/"+e.transaction_hash},(0,o.h)(U,null,e.value)),e.__isSending?(0,o.h)("input",{type:"number",size:"8",onChange:function(t){return r(h)(e,parseInt(t.target.value,10))},min:0,max:e.value,value:parseInt(e.__sendValue>0?e.__sendValue:e.value,10)}):void 0,e.__isSending?e.__toAddressImg?(0,o.h)("img",{src:e.__toAddressImg}):(0,o.h)("input",{type:"text",onChange:function(t){return r(p)(e,t.target.value)},placeholder:"to address",value:e.__toAddress||""}):void 0,e.__isSending?void 0:(0,o.h)("button",{onClick:function(){return r(f)(e)}},"send"))},F=function(t,n){var e=n.mutation,r=n.sendFee,i=n.transactionList;a(t);var u=i.reduce(function(t,n){return t+n.__sendValue},0),c=i.reduce(function(t,n){return t+n.value},0),l=c-u;return console.dir({sendValue:u,utxoValue:c,fee:l}),l>2e3&&alert("fee greater than 2000 satoshi! are you sure??"),(0,o.h)("transaction",null,(0,o.h)(U,null,u),"fee: ",(0,o.h)("input",{type:"number",min:"0",max:l,value:void 0!==r?r:l,onChange:function(t){return e(v)(parseInt(t.target.value,10))}}),"change: ",(0,o.h)(U,null,c-u-(void 0!==r?r:l)))};e.default={data:{name:"Bitcoin Cash",wallets:[{pubKeyAddressString:k.toString(),utxos:[]}]},UI:(0,i.onFirstRun)(function(t,n){var e=n.mutation;console.log("first run init"),e(s)(e,t),console.log({data:t})},function(t,n){t.data;var e=n.mutation,r=n.transactionList;return(0,o.h)("bitcoin-cash-ui",null,(0,o.h)("wallet-info",null,(0,o.h)("public-address",{onClick:e(d)},k.toString()),(0,o.h)("a",{target:"__blank",href:"https://blockchair.com/bitcoin-cash/address/"+k.toString()},(0,o.h)(w,null)),(0,o.h)(M,null),r.length>0?(0,o.h)(F,null):void 0,(0,o.h)("button",{onClick:function(){return e(y)(prompt("how much? (in satoshis please)"))}},"receive"),(0,o.h)("button",{onClick:function(){return alert("not implemented!")}},"mine")))})}},{"./identifier":4,"./utils":6,"bitcore-lib-cash":"bitcore-lib-cash","preact-cycle":"preact-cycle"}],3:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CoinsUI=e.coins=void 0;var o=t("preact-cycle"),r=t("./utils"),i=a(t("./bitcoinCash")),u=a(t("./turtleCoin"));function a(t){return t&&t.__esModule?t:{default:t}}e.coins=[i.default,u.default],e.CoinsUI=(0,r.onFirstRun)(function(){console.log("should only run once!")},function(t){var n=t.coins;return(0,o.h)("coins-ui",null,n.map(function(t){var n=t.UI,e=t.data;return(0,o.h)(n,{data:e})}))})},{"./bitcoinCash":2,"./turtleCoin":5,"./utils":6,"preact-cycle":"preact-cycle"}],4:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("preact-cycle"),r=t("./utils"),i=function(t){return t};e.default=function(t,n){var e=n.mutation;return(0,r.onFirstRun)(function(){console.log("run",t),t.displayValue=(0,o.h)("span",null,t.name)},function(t){return(0,o.h)("identifier",{onClick:(console.log("data",t),e(i))},t.displayValue)})(t)}},{"./utils":6,"preact-cycle":"preact-cycle"}],5:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("preact-cycle");e.default={data:{name:"TurtleCoin",wallets:[]},UI:function(t){var n=t.data;return(0,o.h)("turtlecoin-ui",null,n.name," - under construction")}}},{"preact-cycle":"preact-cycle"}],6:[function(t,n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.onFirstRun=function(t,n){return function(){return t.apply(void 0,arguments),t=function(){},n.apply(void 0,arguments)}}},{}]},{},[1]);